<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Jadual Anjal â€“ Khamis 07 Mei 2025 (Editable)</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.20.0/dist/xlsx.full.min.js"></script>
<style>
 body{font-family:Arial,Helvetica,sans-serif;margin:32px}
 h2{margin-top:0}
 table{border-collapse:collapse;width:100%;margin-top:10px}
 th,td{border:1px solid #999;padding:8px;text-align:center;min-width:90px}
 th{background:#f2f2f2}
 .bar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
 .bar button{padding:8px 14px;font-size:14px;cursor:pointer;border-radius:4px;border:1px solid #555;background:#fff}
 #excelBtn{background:#2e8b57;color:#fff;border:none}
 #saveDraftBtn{background:#0b65c2;color:#fff;border:none}
 #msg{color:#c00;font-size:14px;margin-top:12px;display:none}
</style></head><body>
<h2>Jadual Anjal â€“ Khamis 07 Mei 2025 (Editable)</h2>

<!-- ===== first row of buttons (always visible) ===== -->
<div class="bar">
  <button id="excelBtn"    onclick="saveToExcel()">ğŸ’¾ Save to Excel</button>
  <button id="saveDraftBtn"onclick="saveDraft()">ğŸ’  Save Draft</button>
  <button                 onclick="clearDraft()">ğŸ—‘ï¸ Clear Draft</button>
</div>
<!-- ===== second row (table editing) ===== -->
<div class="bar">
  <button onclick="addRow()">â• Add Row</button>
  <button onclick="deleteRow()">â– Del Row</button>
  <button onclick="addColumn()">â• Add Col</button>
  <button onclick="deleteColumn()">â– Del Col</button>
</div>

<table id="editableTable"><thead><tr>
  <th>7.15 â€“ 8.15</th><th>8.15 â€“ 9.15</th><th>9.15 â€“ 10.15</th>
  <th>10.15 â€“ 10.30 (REHAT)</th>
  <th>10.30 â€“ 11.30</th><th>11.30 â€“ 12.30</th><th>12.30 â€“ 13.00</th>
</tr></thead><tbody>
  <tr><td contenteditable="true">5SN 1</td><td contenteditable="true"></td>
      <td contenteditable="true"></td><td contenteditable="true"></td>
      <td contenteditable="true"></td><td contenteditable="true"></td>
      <td contenteditable="true"></td></tr>
</tbody></table>

<p id="msg">âš ï¸ SheetJS failed to load â€“ â€œSave to Excelâ€ will not work offline.</p>

<script>
const table=document.getElementById('editableTable'), LS_KEY="jadual_khamis07_draft";

/* ---------- table editing ---------- */
function addRow(){const r=table.insertRow(-1);for(let i=0;i<table.rows[0].cells.length;i++){const c=r.insertCell(i);c.contentEditable="true";}}
function deleteRow(){if(table.rows.length>2)table.deleteRow(-1);}
function addColumn(){for(let r=0;r<table.rows.length;r++){const c=table.rows[r].insertCell(-1);c.contentEditable="true";if(r===0)c.outerHTML='<th contenteditable="true"></th>';}}
function deleteColumn(){const n=table.rows[0].cells.length;if(n>1)for(let r=0;r<table.rows.length;r++)table.rows[r].deleteCell(-1);}

/* ---------- local-storage draft ---------- */
function tableArray(){return[...table.rows].map(r=>[...r.cells].map(c=>c.innerText.trim()))}
function arrayToTable(a){[...table.tBodies].forEach(tb=>tb.remove());const tb=table.createTBody();for(let r=1;r<a.length;r++){const tr=tb.insertRow(-1);for(const v of a[r]){const td=tr.insertCell(-1);td.contentEditable="true";td.textContent=v}}}
function saveDraft(){localStorage.setItem(LS_KEY,JSON.stringify(tableArray()));alert("Draft saved!")}
function clearDraft(){localStorage.removeItem(LS_KEY);alert("Draft cleared.")}
(function(){const d=localStorage.getItem(LS_KEY);if(d)try{arrayToTable(JSON.parse(d))}catch(e){}})();

/* ---------- excel export ---------- */
function saveToExcel(){
 if(typeof XLSX==="undefined"){document.getElementById('msg').style.display='block';return;}
 const aoa=tableArray(), ws=XLSX.utils.aoa_to_sheet(aoa);
 ws['!cols']=Array(aoa[0].length).fill({wch:20});
 ws['!pageSetup']={paperSize:9,orientation:'portrait',fitToWidth:1,fitToHeight:0};
 const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Khamis 07');
 XLSX.writeFile(wb,'Jadual_Khamis07.xlsx');
}

/* ---------- SheetJS CDN fallback notice ---------- */
window.addEventListener('error',e=>{if(e.target&&e.target.src&&e.target.src.includes('xlsx'))document.getElementById('msg').style.display='block'},true);
</script>
</body></html>