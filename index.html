<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Jadual Anjal ‚Äì Khamis 07 Mei 2025 (Editable)</title>

<!-- load the local SheetJS copy you added -->
<script src="xlsx.full.min.js"></script>

<style>
 body{font-family:Arial,Helvetica,sans-serif;margin:28px}
 h2{margin:0 0 12px}
 table{border-collapse:collapse;width:100%;margin-top:10px}
 th,td{border:1px solid #999;padding:8px;text-align:center;min-width:90px}
 th{background:#f2f2f2}
 td.selected,th.selected{outline:3px solid #ffdf6a}
 .bar{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px}
 .bar button{padding:8px 12px;font-size:14px;border-radius:4px;cursor:pointer;border:1px solid #666;background:#fff}
 #excelBtn{background:#2e8b57;color:#fff;border:none}
 #saveDraftBtn{background:#0b65c2;color:#fff;border:none}
 #msg{color:#c00;margin-top:10px;display:none}
</style>
</head><body>
<h2>Jadual Anjal ‚Äì Khamis 07 Mei 2025 (Editable)</h2>

<!-- ===== persistence & export ===== -->
<div class="bar">
  <button id="excelBtn"    onclick="toExcel()">üíæ Save to Excel</button>
  <button id="saveDraftBtn"onclick="saveDraft()">üí† Save Draft</button>
  <button                onclick="clearDraft()">üóëÔ∏è Clear Draft</button>
</div>

<!-- ===== targeted actions ===== -->
<div class="bar">
  <button onclick="addRowAbove()">‚¨ÜÔ∏è Row Above</button>
  <button onclick="addRowBelow()">‚¨áÔ∏è Row Below</button>
  <button onclick="deleteRow()">‚ùå Del Row</button>
  <button onclick="addColLeft()">‚¨ÖÔ∏è Col Left</button>
  <button onclick="addColRight()">‚û°Ô∏è Col Right</button>
  <button onclick="deleteCol()">‚ùå Del Col</button>
</div>

<!-- ===== quick add / delete on the end ===== -->
<div class="bar">
  <button onclick="quickAddRow()">‚ûï Add Row (end)</button>
  <button onclick="quickDelRow()">‚ûñ Del Row (end)</button>
  <button onclick="quickAddCol()">‚ûï Add Col (end)</button>
  <button onclick="quickDelCol()">‚ûñ Del Col (end)</button>
</div>

<table id="tbl"><thead><tr>
  <th>7.15 ‚Äì 8.15</th><th>8.15 ‚Äì 9.15</th><th>9.15 ‚Äì 10.15</th>
  <th>10.15 ‚Äì 10.30 (REHAT)</th>
  <th>10.30 ‚Äì 11.30</th><th>11.30 ‚Äì 12.30</th><th>12.30 ‚Äì 13.00</th>
</tr></thead><tbody>
  <tr><td contenteditable="true">5SN 1</td><td contenteditable="true"></td>
      <td contenteditable="true"></td><td contenteditable="true"></td>
      <td contenteditable="true"></td><td contenteditable="true"></td>
      <td contenteditable="true"></td></tr>
</tbody></table>

<p id="msg">‚ö†Ô∏è SheetJS not found ‚Äì export disabled.</p>

<script>
const T=document.getElementById('tbl'), LS_KEY='jadual_khamis07_draft';
let sel={r:0,c:0};          /* selected cell coords */

/* ---------- selection highlight ---------- */
T.addEventListener('click',e=>{
  if(e.target.tagName!=='TD'&&e.target.tagName!=='TH')return;
  [...T.querySelectorAll('.selected')].forEach(c=>c.classList.remove('selected'));
  e.target.classList.add('selected');
  sel={r:e.target.parentNode.rowIndex,c:e.target.cellIndex};
});

/* ---------- helper: create empty cell ---------- */
function makeCell(row,isHeader=false){
  const cell=isHeader?row.insertCell(-1):row.insertCell(-1);
  if(isHeader) cell.outerHTML='<th contenteditable="true"></th>';
  else {cell.contentEditable='true';cell.textContent='';}
}

/* ---------- targeted row / col ops ---------- */
function addRowAbove(){const r=T.insertRow(sel.r);for(let i=0;i<T.rows[0].cells.length;i++)makeCell(r);}
function addRowBelow(){const r=T.insertRow(sel.r+1);for(let i=0;i<T.rows[0].cells.length;i++)makeCell(r);}
function deleteRow(){if(T.rows.length>2)T.deleteRow(sel.r);}
function addColLeft (){for(const row of T.rows){const c=row.insertCell(sel.c);if(row.rowIndex) c.contentEditable='true'; else c.outerHTML='<th contenteditable="true"></th>';}}
function addColRight(){for(const row of T.rows){const c=row.insertCell(sel.c+1);if(row.rowIndex) c.contentEditable='true'; else c.outerHTML='<th contenteditable="true"></th>';}}
function deleteCol(){if(T.rows[0].cells.length>1)for(const row of T.rows)row.deleteCell(sel.c);}

/* ---------- quick ops on table end ---------- */
function quickAddRow(){const r=T.insertRow(-1);for(let i=0;i<T.rows[0].cells.length;i++)makeCell(r);}
function quickDelRow(){if(T.rows.length>2)T.deleteRow(-1);}
function quickAddCol(){for(const row of T.rows){makeCell(row,row.rowIndex===0);}}
function quickDelCol(){const n=T.rows[0].cells.length;if(n>1)for(const row of T.rows)row.deleteCell(-1);}

/* ---------- localStorage draft ---------- */
function tblArray(){return[...T.rows].map(r=>[...r.cells].map(c=>c.innerText.trim()));}
function arrayToTbl(a){
  [...T.tBodies].forEach(tb=>tb.remove());
  const tb=T.createTBody();
  for(let r=1;r<a.length;r++){
    const tr=tb.insertRow(-1);
    for(const v of a[r]){const td=tr.insertCell(-1);td.contentEditable='true';td.textContent=v;}
  }
  /* sync header width if draft had more cols */
  while(T.rows[0].cells.length<a[0].length) addColRight();
}
function saveDraft(){localStorage.setItem(LS_KEY,JSON.stringify(tblArray()));alert('Draft saved!');}
function clearDraft(){localStorage.removeItem(LS_KEY);alert('Draft cleared!');}
(function(){const d=localStorage.getItem(LS_KEY);if(d)arrayToTbl(JSON.parse(d));})();

/* ---------- Excel export ---------- */
function toExcel(){
 if(typeof XLSX==='undefined'){document.getElementById('msg').style.display='block';return;}
 const aoa=tblArray(), ws=XLSX.utils.aoa_to_sheet(aoa);
 ws['!cols']=Array(aoa[0].length).fill({wch:20});
 ws['!pageSetup']={paperSize:9,orientation:'portrait',fitToWidth:1,fitToHeight:0};
 const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Khamis 07');
 XLSX.writeFile(wb,'Jadual_Khamis07.xlsx');
}
</script>
</body></html>